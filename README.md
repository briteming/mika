# ssng
ShadowSocks Next Generation :rocket:

## Feature
1. Support socks5 proxy.

## Mika protocol Spec

### Requset
```
iv is random bytes generated by client.
Key used to encrypt data is gengerated by the first part of password.
--------------------
|   iv  | req data |
--------------------
| Fixed | Variable |
--------------------
```
```
First block of req data (at least 23 bytes):
Chunk id is a unix time when requst was going to be sent. Server must verify chunk id.
Protocol claims how to resolve user data.
------------------------------------------------------------------------
| ver | cmd | reverse | protocol | protocol related | chunck id | hamc |
------------------------------------------------------------------------
|  1  |  1  |    2    |    1     |      Variable    |    8      | 10   |
------------------------------------------------------------------------
ver: 0x1

cmd:
data forward 0x1
server control 0x2

reverse: 0x00

protocols:
TCP data forward(0x1)
---------------------------
| atype | address  | port |
---------------------------
|   1   | Variable |   2  |
---------------------------
HTTP data forward(0x2)
--------------------
| protocol related |
--------------------
|        0         |
--------------------
UDP data forward(0x3)
---------------------------
| atype |  address | port |
---------------------------
|   1   | Variable |   2  |
---------------------------
admin(0x5)
```
```
Other chunks of req data (at least 12 bytes):
Chunk id should increase one after a chunk was sent/recevied successfully. 
Server and client should hold same chunk id for the same chunk.
------------------------------
| dateLen | hamc | user data |
------------------------------
|   2     | 10   | Variable  |
------------------------------
```

### Response
```
iv is same as request.
Key used to encrypt data is gengerated by the last part of password.
-------------
| resp data |
-------------
|  Variable |
-------------
```

## TODO
0. Impl full spec.
1. One time auth against CCA. 
2. Address forbidden.